#include <stdio.h>
#include <stdlib.h>
#include <mqueue.h>
#include <fcntl.h>

#define MESSAGESIZE 2
#define Q_FLAGS O_RDWR | O_CREAT | O_EXCL
#define Q_Mode S_IRUSR | S_IWUSR

void singlestep_trafficlight_statemachine(enum states * currentState){
	switch (*currentState){
		case state0:
			*currentState = state1;
			break;
		case state1:
			printf("EWR-NSR(%d)\n", *currentState);
			sleep(1);
			*currentState = state2;
			break;
		case state2:
			printf("EWG-NSR(%d)\n", *currentState);
			sleep(2);
			*currentState = state3;
			break;
		case state3:
			printf("EWY-NSR(%d)\n", *currentState);
			sleep(1);
			*currentState = state4;
			break;
		case state4:
			printf("EWR-NSR(%d)\n", *currentState);
			sleep(1);
			*currentState = state5;
			break;
		case state5:
			printf("EWR-NSG(%d)\n", *currentState);
			sleep(2);
			*currentState = state6;
			break;
		case state6:
			printf("EWR-NSY(%d)\n", *currentState);
			sleep(1);
			*currentState = state1;
			break;
	}
}

int main(int argc, char *argv[]) {
	mqd_t qd;
	enum states currentState = state0;
	int runTimes = 30, counter = 0;
	char buf[MESSAGESIZE] = {}
	struct mq_attr attribute;
	attribute.mq_maxmsg = 100;
	attribute.mq_msgsize = MESSAGESIZE;
	attribute.mq_flags = 0;
	attribute.mq_curmsgs = 0;
	attribute.mq_sendwait = 0;
	attribute.mq_recvwait = 0;

	struct mq_attr * customAttribute = &attribute;
	const char * mqueueLocation = "/net/receive/traffic_light_queue";

	return EXIT_SUCCESS;
}
